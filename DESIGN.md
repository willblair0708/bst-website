# **Bastion Design Constitution** — *CureGraph Specification*

**Comprehensive Edition v3.0 — August 2025**

> **Estelion’s Charge**   Two diseases cured; ten‑thousand remain. Bastion is the universal forge where every idea, dataset, simulation, and protocol becomes computable, shareable, and merge‑able—so translation moves at software speed.

---

## 0 · Mandate

*This document is the golden record for Bastion’s visual and interaction language.*  A designer or engineer landing on the project must be able to craft a Figma frame, React component, or Framer motion variant that drops into production **pixel‑perfect** and **mission‑aligned** within 24 hours.

> **North‑Star Metric**  » *Life‑days accelerated by Bastion‑hosted work.*  Every interaction should make that ticker rise.

---

## 1 · Design Tenets (root‑level)

1. **Evidence > Ornament** — every pixel must map to a verifiable datum: commit SHA, twin AUC, power estimate, or cryptographic signature. No decorative charts.
2. **Velocity = Mercy** — performance budgets are moral budgets. If it costs milliseconds, justify it.
3. **Clarity, then Delight** — default views favour clinicians & regulators; deeper panels delight power users.
4. **Equity on Surface** — inclusion & demographic metrics share first‑class visual language with statistical power.
5. **Abundance Aesthetic** — subtle motion, gradients, and micro‑copy evoke possibility, not chaos.

---

## 2 · Visual Foundation

### 2.1 Colour System

*Token naming follows* `semantic/objective/variant`.

#### Greyscale (Linear‑sRGB)

|  Token     | Hex      |  Usage                         |
| ---------- | -------- | ------------------------------ |
| `grey/900` |  #0A0C10 | Dark canvas (Dark Mode)        |
| `grey/800` |  #16181D | Panel BG, elevations           |
| `grey/700` |  #20232B | Card borders (Dark)            |
| `grey/600` |  #2F333B | Divider lines                  |
| `grey/500` |  #495057 | Secondary icons, disabled text |
| `grey/400` |  #6C757D | Placeholder text               |
| `grey/300` |  #A1A7B3 | Dim text on Dark               |
| `grey/100` |  #F5F8FA | Panel BG (Light)               |
| `white`    |  #FFFFFF | Canvas (Light Mode)            |

#### Functional Palette

|  Semantic      |  Role          |  Light  |  Dark   |
| -------------- | -------------- | ------- | ------- |
| `accent/pass`  | Success, links | #19A7CE | #19A7CE |
| `accent/fail`  | Error          | #FF6B6B | #FF6B6B |
| `accent/warn`  | Warning        | #FFB454 | #FFB454 |
| `accent/merit` | Equity Gold    | #F3C94C | #F3C94C |

**AA / AAA Compliance:**  All text on background tokens meets WCAG AA; primary buttons AAA. Colour tokens stored in CSS variables & Tailwind config generated by `figma‑tokens` pipeline.

### 2.2 Typography Scale

|  Use Case   |  Font         |  Size (px) |  Line  |  Weight |
| ----------- | ------------- | ---------- | ------ | ------- |
| Display XL  | Inter         | 28         | 1.2    | 600     |
| Display L   | Inter         | 22         | 1.25   | 600     |
| Body M      | Inter         | 15         | 1.5    | 400     |
| Body S      | Inter         | 13         | 1.5    | 400     |
| Code / Mono | IBM Plex Mono | 13         | 1.45   | 400     |

Letter‑spacing −0.25 px for headings, 0 px for body.

### 2.3 Spacing & Grid

* **4 px baseline grid**.  Spacing tokens: `sp/0=0, sp/1=4, sp/2=8, sp/3=12, sp/4=16, sp/6=24, sp/8=32, sp/12=48, sp/16=64`.
* **12‑column responsive grid** with 72 px gutters ≥ 1440 px; collapses to 8‑col at 1024 px, 4‑col at 768 px, single‑col mobile.

### 2.4 Iconography

* **Lucide** base + custom line icons (DNA helix, syringe, shield, rocket).  Stroke 1.5 px Dark, 1.25 px Light.  Icons follow 24 × 24 bounding‑box.

### 2.5 Imagery & Illustration

* **No stock photography.**  Abstract gradient “Aurora Ribbons” and vector fieldlines evoke computational biology.  Asset prefix `aurora/*` in CDN.

---

## 3 · Motion & Micro‑Interactions

### 3.1 Global Motion Rules

* **Physics** — Framer Motion spring `{stiffness:140, damping:24, mass:1}`.
* **Durations** — Short 120 ms, Base 180 ms, Long 240 ms (keyframes only).
* **Preference Respect** — `prefers-reduced-motion` disables all but essential transitions; `?audit=1` query param locks animations.

### 3.2 Component Animations

| Component       | Trigger        |  Animation                                   |  Purpose                                            |
| --------------- | -------------- | -------------------------------------------- | --------------------------------------------------- |
| Status Badge    | Metric change  | Flip Y 180°, counterincrement, colour fade ± | Signifies new evidence like NASA mission patch flip |
| CI Log Line     | Stream ingress | Slide in `x:[‑8→0]`, opacity `[0→1]`         | Feels like telemetry feed                           |
| CureGraph Dive  | Node click     | Framer Layout shared‑id morph                | Maintains spatial context                           |
| Aurora Gradient | Passive        | 90 s keyframe hue shift                      | Subtle “living system” feeling                      |

---

## 4 · Information Architecture

```
├─ Home (Hero + Aurora Ribbon + Cure‑Counter)
│    └─ Story • Recent Milestones • CTA to Discover
├─ Discover ↦ Search & facets (Trial | Twin | Dataset | Hypothesis)
├─ Workspace ↦ My repos • PRs • CI Status • Graph of Life‑Days Saved
├─ CureGraph ↦ Zoomable DAG (Dagre) • Evidence maturity colours
├─ Ops Dashboard ↦ Map, dropout risk, reg queue status (Anduril style)
├─ Marketplace ↦ Plug‑ins • Widgets • Stars • Trust score
└─ Governance ↦ Org roles • Reg portals • Audit exports
```

Breadcrumb: `org / repo @ commit • signer‑hash‑8`. Copy on header click copies deep‑link.

---

## 5 · Component Library (`@bastion/ui`)

| Component                                               | Props (excerpt)                  |
| ------------------------------------------------------- | -------------------------------- |
| `<Badge metric="power" value={0.83} state="pass" />`    | metric, value, state             |
| `<ProtocolDiff old={str} new={str} view="clinician" />` | old, new, view                   |
| `<EvidenceDrawer artifact={url} />`                     | link to HTML/nb artifact         |
| `<CureGraph dag={json} />`                              | JSON DAG, layout options         |
| `<TwinPlot data={parquet} x="Age" y="Tumour_Size" />`   | Dense scatter WebGL              |
| `<DiversityRadar scores={obj} />`                       | Radar chart, accessible alt‑text |

All components use Tailwind class tokens + Radix primitives; support theme context.

---

## 6 · Accessibility & Inclusivity

* **WCAG AA** minimum for all surfaces; AAA for primary buttons.
* **Dyslexia Mode** — Atkinson Hyperlegible, background tint `#F6F8FF`.
* **Screen Reader** — YAML diffs parsed into ARIA live‑regions that announce semantic changes.
* **Keyboard** — Tab loop order matches visual order; skip‑links for main content.

---

## 7 · Performance & Technical

| KPI                      | Target              | Budget Notes                       |
| ------------------------ | ------------------- | ---------------------------------- |
| First Contentful Paint   | ≤ 1 s on 4 G median | Edge caching, skeletons            |
| Largest Contentful Paint | ≤ 2 s               | Lazy load heavy graphs             |
| Interactive CI latency   | ≤ 200 ms P95        | SSE + Redis streams                |
| Bundle size per route    | ≤ 150 kB (gz)       | `react-email`, lucide tree‑shaking |
| Mobile memory            | ≤ 300 MB            | Offload graphs to web‑worker       |

**Stack** — Next.js 15 + RSC, React 18, Framer Motion 10, Tailwind 3.x, Supabase (control‑plane), K8s + Argo (CI), Delta Lake (data‑plane).

---

## 8 · Compliance Overlay

* **Rust Part 11 Signer** — Signs merge commit JSON; weekly anchor to AWS QLDB.
* **pg\_audit + WAL** → S3 Glacier (immutability policy).
* **Privacy Kit** — PHI column detection, Safe‑Harbor masks; runs pre‑merge.

---

## 9 · Governance & Versioning

* **Design Council** (PM, Design, Clinician, Patient) meets monthly;
* Design RFCs via `estelion/rfcs`; two‑week review for breaking changes.
* λ‑Trial DSL under SemVer; migrations auto‑generated and tested in CI.

---

## 10 · Horizon – Inspirational Features

| Phase | Innovation                                         | Why It Matters                                      |
| ----- | -------------------------------------------------- | --------------------------------------------------- |
|  2026 | **Copilot‑for‑Clinicians** (GPT‑4o agent)          | Suggests eligibility edits, speeds design.          |
|  2027 | **Spatial Trials** (3‑D organ twins, radiotherapy) | Visual dose planning; patient‑specific predictions. |
|  2028 | **zk‑Data‑Dividend**                               | Zero‑knowledge token payouts to participants.       |
|  2029 | **VR Mission Control**                             | Global regulators review CureGraph together in VR.  |

---

## 11 · Voice & Tone Cheat Sheet

* **Voice:** Visionary yet evidence‑driven—“Skunkworks engineer meets clinical ethicist.”
* **Tone:** Concise, data‑first, optimistic. Avoid medical jargon unless needed.
* **Micro‑copy:** Actionable verbs (Fork, Simulate, Merge). Error messages state remediation steps.

---
